define(["vue","webuploader","css!commoncss","css!webuploadercss","css!personalInfoCSS","common","vue.template"],function(e,a){function n(){var n,t,i=this;this.init=function(e){n=e.type,i.handleBackClick(),t="pageReinit"==n?t:i.render("userInfo"),i.ajaxData(ajaxUrl.personInfo,t),i.handleImgUpload()},this.render=function(a,n){return new e({el:"#"+a,data:{data:n||{}}})},this.ajaxData=function(e,a){ajaxData("GET",e,function(e){a.data=e})},this.handleImgUpload=function(){var e=a.create({auto:!1,prepareNextFile:!0,duplicate:!0,chunked:!0,server:ajaxUrl.imgUpload,pick:"#headImg",accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},compress:{width:500,height:500,quality:80,allowMagnify:!1,crop:!1,preserveHeaders:!0,noCompressIfLarger:!1,compressSize:0},withCredentials:!0});e.on("fileQueued",function(a){e.upload();var n=$("#userInfo .user-header");e.makeThumb(a,function(e,a){e||n.attr("src",a)},n.width(),n.height())}),e.on("uploadSuccess",function(e,a){0===a.resCode&&i.ajaxData(ajaxUrl.personInfo,t)})},this.handleBackClick=function(){$(".app-btn-back").off("click").on("click",function(){history.back()})}}return new n});